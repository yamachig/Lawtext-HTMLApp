"use strict";

var Lawtext = Lawtext || {};
Lawtext.sidebar_view_template = "\n\n<style style=\"display: none;\">\n.lawtext-sidebar-view {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n\n.lawtext-sidebar-view h1 {\n  text-align: center;\n  margin-top: 1rem;\n  color: rgb(75, 75, 75);\n}\n\n.lawtext-sidebar-view .sidebar-head-block {\n  flex-grow: 0;\n  margin-bottom: 1rem;\n}\n\n.lawtext-sidebar-view .sidebar-body-block {\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n.lawtext-sidebar-view .law-nav-block {\n  flex-grow: 1;\n  flex-basis: 0;\n  overflow-y: auto;\n  border-top: 1px solid #d6d6d6;\n  border-bottom: 1px solid #d6d6d6;\n  padding: 0.4rem 0;\n  font-size: 0.75em;\n}\n\n.lawtext-sidebar-view .toc-item {\n  text-indent: -1em;\n  overflow-x: hidden;\n  overflow-y: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.lawtext-sidebar-view .toc-item:hover {\n  background-color: rgba(255, 255, 255, .8);\n  cursor: pointer;\n}\n\n.list-group-item-sm {\n  font-size: 0.8em;\n  padding: 0.5em;\n}\n\n.lawtext-sidebar-view .sidebar-footer-block {\n  flex-shrink: 0;\n  display: flex;\n  flex-direction: column;\n}\n</style>\n\n<div class=\"sidebar-head-block\">\n  <div class=\"container-fluid\">\n\n    <h1><a href=\"<%= location.protocol + '//' + location.host + location.pathname + location.search %>\" style=\"color: inherit;\">Lawtext</a></h1>\n\n    <% if(!data.opening_file) { %>\n      <div class=\"list-group\" style=\"text-align: center;\">\n\n        <button class=\"lawtext-open-file-button list-group-item list-group-item-sm list-group-item-action\">\u6CD5\u4EE4\u30D5\u30A1\u30A4\u30EB\u3092\u958B\u304F</button>\n\n        <form class=\"list-group-item list-group-item-sm\" style=\"padding: 0;\">\n          <div class=\"input-group\">\n            <input class=\"form-control form-control-sm search-law-textbox\"\n                  style=\"border: none; padding: 0.45em; border-radius: 0; border-bottom-left-radius: .25rem;\"\n                  placeholder=\"\u6CD5\u4EE4\u540D\u304B\u6CD5\u4EE4\u756A\u53F7\u3092\u691C\u7D22\" aria-label=\"\u6CD5\u4EE4\u540D\u304B\u6CD5\u4EE4\u756A\u53F7\u3092\u691C\u7D22\"\n                  <% if(data.law_search_key) { %>value=\"<%= data.law_search_key %>\"<% } %>\n                  >\n            <span class=\"input-group-btn\">\n              <button class=\"btn btn-sm btn-secondary search-law-button\" type=\"submit\"\n                  style=\"border-radius: 0; border-bottom-right-radius: .25rem;\"\n                  >\n                \u691C\u7D22\n              </button>\n            </span>\n          </div>\n        </form>\n\n      </div>\n    <% } %>\n\n    <% if(!_(data.law).isNull()) { %>\n      <div style=\" margin-top: 0.5rem;\">\n        <span style=\"font-size: .875rem;\">\u4FDD\u5B58\uFF1A</span>\n        <span class=\"btn-group btn-group-sm\">\n          <button class=\"lawtext-download-docx-button btn btn-outline-primary\">Word</button>\n          <button class=\"lawtext-download-lawtext-button btn btn-outline-primary\">Lawtext</button>\n          <button class=\"lawtext-download-xml-button btn btn-outline-primary\">\u6CD5\u4EE4XML</button>\n        </span>\n      </div>\n    <% } %>\n\n  </div>\n\n</div>\n\n<div class=\"sidebar-body-block\">\n<% if(!_(data.law).isNull()) { %>\n\n  <div class=\"law-nav-block\">\n\n<% // <script>\n\nvar law_body = _(data.law.children).findWhere({tag: \"LawBody\"});\n\nfunction process_law_body(law_body) {\n    _(law_body.children).each(function(el){\n        if(el.tag == \"TOC\") {\n            process_toc(el);\n        } if(el.tag == \"MainProvision\") {\n          process_article_group(el, indent=0);\n        } else if(el.tag == \"SupplProvision\") {\n            process_suppl_provision(el);\n        } else if(el.tag == \"AppdxTable\") {\n            process_appdx_table(el);\n        } else if(el.tag == \"AppdxStyle\") {\n            process_appdx_style(el);\n        }\n    });\n}\n\nfunction process_toc(toc) {\n    var toc_label = _(toc.children).findWhere({tag: \"TOCLabel\"});\n    if(toc_label) {\n        var name = toc_label.children[0];\n        var obj = $(\"<div>\")\n            .addClass(\"toc-item law-link\")\n            .css({\"padding-left\": \"2em\"})\n            .attr({\"data-tag\": toc.tag})\n            .attr({\"data-name\": name})\n            .attr({\"title\": name})\n            .html(name);\n        print(obj[0].outerHTML);\n    }\n}\n\nfunction process_article_group(article_group, indent) {\n    var article_group_title = _(article_group.children).findWhere({tag: article_group.tag + \"Title\"});\n    if(article_group_title) {\n      var name = article_group_title.children[0];\n        var obj = $(\"<div>\")\n            .addClass(\"toc-item law-link\")\n            .css({\"padding-left\": (indent + 2) + \"em\"})\n            .attr({\"data-tag\": article_group.tag})\n            .attr({\"data-name\": name})\n            .attr({\"title\": name})\n            .html(name);\n        print(obj[0].outerHTML);\n    }\n\n    _(article_group.children).each(function(el){\n        if(_(['Part', 'Chapter', 'Section', 'Subsection', 'Division']).contains(el.tag)) {\n            process_article_group(el, article_group.tag == \"MainProvision\" ? indent : indent + 1);\n        } else if(el.tag == \"Article\") {\n            process_article(el, article_group.tag == \"MainProvision\" ? indent : indent + 1);\n        }\n    });\n}\n\nfunction process_article(article, indent) {\n    var article_caption = _(article.children).findWhere({tag: \"ArticleCaption\"});\n    var article_title = _(article.children).findWhere({tag: \"ArticleTitle\"});\n\n    if(article_title) {\n        var name = article_title.children[0];\n        var text = name;\n        if(article_caption) {\n            var append_text = article_caption.children[0];\n            text += (append_text[0] == \"\uFF08\" ? \"\" : \"\u3000\") + append_text;\n        }\n        var obj = $(\"<div>\")\n            .addClass(\"toc-item law-link\")\n            .css({\"padding-left\": (indent + 2) + \"em\"})\n            .attr({\"data-tag\": article.tag})\n            .attr({\"data-name\": name})\n            .attr({\"title\": text})\n            .html(text);\n        print(obj[0].outerHTML);\n    }\n}\n\nfunction process_suppl_provision(suppl_provision) {\n    var suppl_provision_label = _(suppl_provision.children).findWhere({tag: \"SupplProvisionLabel\"});\n    if(suppl_provision_label) {\n        var name = suppl_provision_label.children[0];\n        var amend_law_num = suppl_provision.attr[\"AmendLawNum\"] || \"\";\n        var text = name + (amend_law_num ? (\"\uFF08\" + amend_law_num + \"\uFF09\") : \"\");\n        text = text.replace(/[s\u3000]+/, \"\");\n        var obj = $(\"<div>\")\n            .addClass(\"toc-item law-link\")\n            .css({\"padding-left\": (indent + 2) + \"em\"})\n            .attr({\"data-tag\": suppl_provision.tag})\n            .attr({\"data-name\": name + amend_law_num})\n            .attr({\"title\": text})\n            .html(text);\n        print(obj[0].outerHTML);\n    }\n}\n\nfunction process_appdx_table(appdx_table) {\n    var appdx_table_title = _(appdx_table.children).findWhere({tag: \"AppdxTableTitle\"});\n    if(appdx_table_title) {\n        var name = appdx_table_title.children[0];\n        var obj = $(\"<div>\")\n            .addClass(\"toc-item law-link\")\n            .css({\"padding-left\": (indent + 2) + \"em\"})\n            .attr({\"data-tag\": appdx_table.tag})\n            .attr({\"data-name\": name})\n            .attr({\"title\": name})\n            .html(name);\n        print(obj[0].outerHTML);\n    }\n}\n\nfunction process_appdx_style(appdx_style) {\n    var appdx_style_title = _(appdx_style.children).findWhere({tag: \"AppdxStyleTitle\"});\n    if(appdx_style_title) {\n        var name = appdx_style_title.children[0];\n        var obj = $(\"<div>\")\n            .addClass(\"toc-item law-link\")\n            .css({\"padding-left\": (indent + 2) + \"em\"})\n            .attr({\"data-tag\": appdx_style.tag})\n            .attr({\"data-name\": name})\n            .attr({\"title\": name})\n            .html(name);\n        print(obj[0].outerHTML);\n    }\n}\n\nprocess_law_body(law_body);\n\n// </script> %>\n  </div>\n<% } %>\n</div>\n\n\n<div class=\"sidebar-footer-block\">\n  <div style=\"font-size: 0.8em; text-align: center; padding: 0.3em 0; color: rgb(192, 192, 192)\">\n    <a href=\"https://github.com/yamachig/lawtext\" target=\"_blank\" style=\"margin-right: 2em;\">\n      GitHub\n    </a>\n    &copy; <%= new Date().getFullYear() %> yamachi\n  </div>\n\n</div>\n";
